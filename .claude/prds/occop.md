---
name: occop
description: 在公共环境中安全调用AI编程工具的Windows桌面应用程序
status: backlog
created: 2025-09-17T03:00:32Z
---

# PRD: occop

## 执行概要

occop 是一个专为公共环境（如网吧）设计的Windows桌面安全工具，旨在解决在不安全环境中使用AI编程工具时的敏感信息泄露风险。该工具通过GitHub身份验证、自动环境配置、临时凭证管理和会话后清理，确保用户能够安全地在任何环境中使用Claude Code。

## 问题陈述

### 核心问题
- **敏感信息泄露风险**：在网吧等公共环境中使用AI编程工具时，API密钥和BASE_URL等敏感信息可能被意外泄露
- **环境配置复杂性**：每次使用需要手动配置环境变量或配置文件，容易出错且效率低下
- **清理不彻底**：手动清理敏感信息容易遗漏，存在安全隐患

### 为什么现在重要
- AI编程工具使用频率增加，公共环境使用需求增长
- 中转服务API密钥价值较高，泄露后果严重
- 缺乏专门的安全工具来解决这一痛点

## 用户故事

### 主要用户角色
**AI编程爱好者（Jeff）**
- 经常在网吧和朋友聚会时也想处理工作项目
- 拥有AI模型中转服务的API密钥
- 需要在不安全环境中安全使用AI编程工具

### 用户旅程
1. **启动阶段**：在网吧打开occop工具
2. **身份验证**：通过GitHub账户验证身份
3. **自动配置**：工具自动检测环境并配置AI工具
4. **安全使用**：通过工具安全调用Claude Code
5. **自动清理**：AI工具退出后自动清理所有敏感信息

### 痛点
- 手动配置环境变量容易出错
- 担心忘记清理敏感信息
- 在公共环境中缺乏安全保障

## 需求

### 功能性需求

#### 1. 身份验证系统
- **GitHub OAuth集成**：使用GitHub Device Flow进行身份验证
- **用户白名单**：仅允许指定GitHub用户访问
- **会话管理**：验证成功后维持会话状态

#### 2. 环境检测和选择
- **Shell环境检测**：自动检测PowerShell和Git Bash安装情况
- **优先级选择**：PowerShell最新版本 > Git Bash
- **AI工具检测**：检测Claude Code安装状态

#### 3. 自动配置管理
- **Claude Code配置**：
  - 临时设置环境变量：`ANTHROPIC_AUTH_TOKEN`和`ANTHROPIC_BASE_URL`
  - 会话结束后自动清理环境变量

#### 4. 进程监控和清理
- **Claude Code进程监控**：实时监控调用的Claude Code进程状态
- **自动清理机制**：Claude Code退出后立即清理所有敏感信息
- **异常处理清理**：程序异常退出时确保敏感信息被清理

#### 5. 日志记录
- **操作日志**：记录关键操作（不包含敏感信息）
- **安全日志**：记录身份验证和清理操作
- **调试信息**：便于问题排查

### 非功能性需求

#### 性能要求
- 启动时间 < 3秒
- 身份验证响应时间 < 5秒
- 环境检测和配置时间 < 2秒

#### 安全要求
- **零持久化存储**：敏感信息仅在内存中临时存储
- **完整清理保证**：程序退出时确保所有敏感信息被清理
- **网络通信加密**：所有网络通信使用HTTPS
- **最小权限原则**：仅请求必要的系统权限

#### 可用性要求
- **用户界面简洁**：最小化用户操作步骤
- **错误提示清晰**：提供明确的错误信息和解决建议
- **一键操作**：整个流程尽可能自动化

#### 兼容性要求
- **操作系统**：Windows 10/11
- **PowerShell版本**：支持PowerShell 5.1+和PowerShell Core 7+
- **Git Bash支持**：支持Git for Windows附带的Git Bash

## 成功标准

### 关键指标
- **安全性**：零敏感信息泄露事件
- **可用性**：完整使用流程 < 30秒
- **可靠性**：99%的清理成功率
- **用户满意度**：解决公共环境使用顾虑

### 验收标准
- [ ] 成功通过GitHub身份验证
- [ ] 正确检测和选择Shell环境
- [ ] 自动配置Claude Code环境变量
- [ ] 实时监控Claude Code进程状态
- [ ] Claude Code退出后完整清理敏感信息
- [ ] 程序异常退出时触发清理机制
- [ ] 生成完整的操作日志

## 约束和假设

### 技术约束
- **平台限制**：仅支持Windows平台
- **依赖工具**：需要Claude Code预先安装
- **网络要求**：需要互联网连接进行GitHub身份验证

### 假设
- 用户已有有效的GitHub账户
- 用户已安装Claude Code
- 用户有PowerShell或Git Bash环境
- 网络环境允许访问GitHub和AI服务

### 限制
- 不支持多用户同时使用
- 不提供API密钥管理功能
- 不支持自定义配置模板

## 范围外功能

明确不包含在此版本中的功能：
- 跨平台支持（macOS/Linux）
- API密钥存储和管理
- 多用户权限管理
- 自定义配置预设
- Claude Code的安装和更新
- 网络代理配置
- 备份和恢复功能

## 依赖关系

### 外部依赖
- **GitHub API**：用于身份验证
- **Claude Code CLI**：目标AI工具
- **Windows API**：进程管理和环境变量操作

### 内部依赖
- 身份验证模块必须在配置模块之前完成
- 环境检测必须在Claude Code调用之前完成
- 清理模块依赖于进程监控模块的状态反馈

## 实现计划

### 第一阶段：核心功能开发
- GitHub OAuth身份验证
- 环境检测和选择逻辑
- 基本配置管理

### 第二阶段：安全增强
- 自动清理机制
- 异常处理和恢复
- 进程监控系统

### 第三阶段：用户体验优化
- 日志记录系统
- 错误处理和用户反馈
- 性能优化和测试